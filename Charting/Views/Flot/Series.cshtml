@model dynamic

@{
    ViewBag.Title = "Series Chart";
}

@section AdditionalScripts
{
    <script src="~/Scripts/jquery.flot.js"></script>
    
    <script type="text/javascript">
        $(function() {
            var datasets = {};

            $.get('@Url.Action("OrdersByMonth", "OrderHistory")', function (data) {
                console.log(data);
                datasets = {
                    "approver": {
                        label: "approver",
                        data: data
                    },
                    "completed": {
                        label: "completed",
                        data: data
                    }
                };

                var statusContainer = $("#statuses");
                $.each(datasets, function(key, val) {
                    statusContainer.append('<li><label for="id' + key + '"><input type="checkbox" name="'
                        + key + '" checked="checked" id="id' + key + '"> '
                        + val.label + '</label></li>');
                });

                statusContainer.find("input").click(plotAccordingToChoices);
                plotAccordingToChoices();
            });

            function plotAccordingToChoices() {
                var data = [];

                $("#statuses").find("input:checked").each(function() {
                    var key = $(this).attr("name");
                    if (key && datasets[key])
                        data.push(datasets[key]);
                });

                $.plot($("#placeholder"), data,
                    {
                        xaxis: {
                            ticks: [[1, "January"], [2, "February"], [3, "March"], [4, "April"], [5, "May"], [6, "June"], [7, "July"], [8, "August"],
                                [9, "September"], [10, "October"], [11, "November"], [12, "December"]]
                        },
                        bars: { show: true }
                    }
                );
            }
        });
    </script>
}

<h2>Series Chart</h2>

<div class="well">
    <p>Show orders with status:</p>
    <ul id="statuses" class="unstyled">
    </ul>
</div>
<div class="well">
    <p class="lead">Bar chart showing order count by month and by type</p>
    <div id="placeholder" style="width:1000px;height:300px"></div>
</div>